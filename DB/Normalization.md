# 정규화

### 1. 배경

한 relation에 여러 entity의 attribute들을 혼합하게 되면 정보가 중복 저장. 저장 공간 낭비

-> `갱신 이상` 발생 : 동일한 정보를 한 relation에서 변경하고, 나머지에서 변경 안하면 어느 것이 정확한지 알 수 없다. 이러한 문제를 해결하기 위해 정규화를 한다.



#### 1-1. 갱신 이상

- 삽입 이상 : 원하지 않는 자료가 삽입, 자료가 부족해 삽입이 안됌
- 삭제 이상 : 하나의 자료만 삭제하고 싶은데, 그 자료가 포함된 튜플 전체가 삭제
- 수정 이상 : 일부 튜플만 갱신되어 정보가 모호해져 정확한 정보 파악이 안됌



### 2. 정규화란 무엇인가

> 관계형 DB에서 중복을 최소화 하기위해 데이터를 구조화 하는 작업
>
> 나쁜 relation의 attribute를 나누어 좋은 relation으로 분해나는 작업
>
> 정규화 시 정규형을 만족하게 된다.



#### 2-1. 나쁜 릴레이션은 어떻게 파악?

entity를 구성하는 attribute 간에 Functional Dependency를 판단. 이것은 좋은 릴레이션 설계의 기준으로 사용



#### 2-2. 함수적 종속성(Functional Dependency)이란?

애트리뷰트 데이터들의 의미와 애트리뷰트들 간의 상호 관계로부터 유도되는 제약 조건의 일종

X 와 Y를 임의의 애트리뷰트 집합이라 할 때, X의 값이 Y의 값을 유일하게 결정하면 X 는  Y를 함수적으로 결정한다 라고 한다.



#### 2-3. 각각의 정규형은 어떠한 조건을 만족해야 하는가?

1. 분해 대상인 분해 집합 D는 **무손실 조인** 을 보장해야 한다.
2. 분해 집합 D는 함수적 종속성을 보존해야 한다.



#### 2-4. 정규형의 종류

#### 1) 제 1 정규형

애트리뷰트의 도메인이 오직 `원자값`만을 포함, 튜플의 모든 애트리뷰트가 도메인에 속하는 하나의 값을 가져야 한다.

#### 2) 제 2 정규형

모든 비주요 애트리뷰트 들이 주요 애트리뷰트에 대해서 완전 함수적 종속이다.

#### 3) 제 3 정규형

어떠한 비주요 애트리뷰트도 기본 키에 대해서 이행적으로 종속되지 않는다.

#### 4) BNCF(Boyce-Codd) 정규형

여러 후보 키가 존재하는 릴레이션에 해당하는 정규화 내용. 제 3 정규형을 보완한다. 비 주요 애트리뷰트가 후보키의 일부를 결정하는 분해 과정을 말한다.

*각 정규형은 그 선행 정규형보다 더 엄격한 조건을 갖는다.*

- 제 2 정규형 릴레이션은 제 1 정규형을 갖는다.
- 제 3 정규형 릴레이션은 제 2 정규형을 갖는다.
- BNCF는 제 3 정규형을 갖는다.

> 관계형 DB의 설계 목표는 각 릴레이션이 3NF(or BCNF)를 갖게 하는 것이다.



### 3. 정규화에는 어떠한 장점?

1. DB 변경시 이상현상 제거
2. DB 확장시 재 디자인 최소화
3. 사용자에게 데이터 모델을 더 의미있게 제공. 현실 셰계와 비슷하게



### 4. 단점

릴레이션 분해로 인해 연산이 많아진다. 이로 인해 질의의 응답시간이 느려질 수 있다.

정규화 하는 것은 데이터 중복 속성을 제거하고 동일한 의미의 속성이 하나의 테이블에 집약되므로 한 테이블의 데이터 용량이 최소화된다.

따라서 정규화된 테이블은 데이터 처리 속도가 빨라질 수도 있고 느려질 수도 있다.



### 5. 어떠한 상황에서 정규화 해야할까? 단점에 대한 대응은?

조회시 **조인**이 많이 발생해 이로 인한 성능저하가 나타나는 경우 반정규화를 적용해야 한다.

#### 반정규화(De-normalization, 비정규화)

정규화된 애를 시스템 성능 향상 및 개발,운영의 단순화를 위해 중복 통합, 분리등을 수행하는 것.

일반적으로 조회 처리 성능이 중요할 때 반정규화 고려



#### 5-1. 반정규화의 대상?

1. 자주 사용되는 테이블에 엑세스하는 프로세스의 수가 가장 많고, 항상 일정한 범위만을 조회하는 경우
2. 테이블에 대량 데이터 있고 대량 범위를 자주 처리하는 경우, 성능 상 이슈가 있을 경우
3. 테이블에 지나치게 조인을 많이 사용해 데이터 조회가 어려울 경우



#### 5-2. 반정규화 과정에서 주의할 점?

하다보면 데이터 무결성이 깨질 수 있다. 또 입력,수정,삭제 질의에 대한 응답시간이 느려질 수 있다.

